#!/bin/bash

# Browser State Viewer CLI wrapper script
# This script automatically activates the virtual environment and runs the state viewer utility

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Path to the project root (two levels up from cli_tools/browser-use-cli/)
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

# Virtual environment paths
VENV_DIR="$PROJECT_ROOT/.venv"
VENV_PYTHON="$VENV_DIR/bin/python"
VENV_ACTIVATE="$VENV_DIR/bin/activate"

# Check if virtual environment exists
if [ ! -d "$VENV_DIR" ]; then
    echo "‚ùå Error: Virtual environment not found at $VENV_DIR"
    echo "üí° Please create the virtual environment first:"
    echo "   cd $PROJECT_ROOT && python -m venv .venv"
    exit 1
fi

# Check if virtual environment Python exists
if [ ! -f "$VENV_PYTHON" ]; then
    echo "‚ùå Error: Virtual environment Python not found at $VENV_PYTHON"
    echo "üí° Please ensure the virtual environment is set up correctly"
    exit 1
fi

# Auto-activate virtual environment and run state viewer
source "$VENV_ACTIVATE"

# Execute the state viewer with all arguments passed through
exec python "$SCRIPT_DIR/src/state_viewer.py" "$@" 